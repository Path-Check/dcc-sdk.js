const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, signAndPack32, signAndPack45, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('CH', async () => {
  it('should verify CH_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCFS605G0/3WUWGSLKH47GO0KNJ9DSWQIIWT9CK4600XKY-CE59-G80:84F35RIV R2F3FMMTTBY50.FK6ZK7:EDOLOPCO8F6%E3.DA%EOPC1G72A6YM83G7NA7H:6JM8D%6I:61S8ZW6HL6C460S8VF6VX6UPC0JCZ69FVCPD0LVC6JD846Y96A466W5B56+EDG8F3I80/D6$CBECSUER:C2$NS346$C2%E9VC- CSUE145GB8JA5B$D% D3IA4W5646946%96X47.JCP9EJY8L/5M/5546.96D463KC.SC4KCD3DX47B46IL6646H*6Z/E5JD%96IA74R6646407GVC*JC1A6/Q63W5KF6746TPCBEC7ZKW.CU2DNXO VD5$C JC3/DMP8$ILZEDZ CW.C9WE.Y9AY8+S9VIAI3D8WEVM8:S9C+9$PC5$CUZCY$5Y$5FBBM00T%LTAT1MOQYR8GUN$K15LIGG2P27%A46BT52VUTL.1*B89Y5B428HRSR3I/E5DS/8NBY4H2BCN8NP1D4B:0K9UQQ67BLTH21AF0V8G52R 62+5BQYCV03SO79O6K+8UXL$T4$%RT150DUHZK+Q9TIE+IMQU4E/Q4T303TKWNXTSORE.4WNPCJX66NN-2F9IHTYLR6IR UAB98RR1A0P9DL0CS5KZ*HEGT1%TQWELFQHG5/JO9TI:.T1JQF.K7 EJ 2/CI5GASQP7ULRX4-07%9W2139E2HMGW99Q DQJADB3UAJKUCOVLG+9T+J:15.12U+OBMCJ1KZ+C+87I8I9JGA0T%U2CMFHI5U:L400C.CC/K3KJZ3OM/D59TBL5AZFMPIW4';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'nam': {'fn': 'Müller', 'fnt': 'MUELLER', 'gn': 'Céline', 'gnt': 'CELINE'}, 'dob': '1943-02-01', 'ver': '1.0.0', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1507', 'ma': 'ORG-100031184', 'dn': 2, 'sd': 2, 'dt': '2021-04-30', 'co': 'CH', 'is': 'Bundesamt für Gesundheit (BAG)', 'ci': 'urn:uvci:01:CH:2987CC9617DD5593806D4285'}]});
  });

  it('should verify CH_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCF060XG0/3WUWGSLKH47GO0KNJ9DSWQIIWT8CK DV/70YM8N34GB8FN0ZKCJ15WY03AC *UD97TK0F90GECQHGWJC0FDL:4:KEPH7M/ESDD746KG7+59/96GM8VW6/A8FM8/A8A46L*8/Q6RL60R6JM8WJCT3EYM8XJCS.CNF6OF63W59%6D46XJC/$ENF6OF64W5Y96RF6ZJC+KENF6OF63W5NW6VF6%JC+QE$.32%E6VCHQEU$DE44NXOBJE719$QE0/D+8D-ED.24-G8$:84KCD3DX47B46IL6646I*6GVC*JC1A6/Q63W5KF6746TPCBEC7ZKW.CU2DNXO VD5$C JC3/DMP8$ILZEDZ CW.C9WE.Y9AY8+S9VIAI3D8WEVM8:S9C+9$PC5$CUZCY$5Y$5FBB-205HKSUV$15H+9-IS1WQ1P3LP8O2ERWUC 1LR3E23EAGSFFPBE5 PKZI:-290EUR6:SAE0379W:R8:836/96Y3.FK0XC+2S57P*GJEZ2XATH.V %TZS1%VIHV940LOBWC6C9-6%Y6.RCHHV+2LP V:LP9K2-127-0DZECY00LC*/BRXCTS1GDTC7JX7OLREQ9GH32UT8.WSXD3UAMLKRGB9GRRN21N4VX:J9B88*3IJ0Q I5C5$0CL-MN.KJ69.9AF:L+AL5DAL0B9UTR6JWM6AR4PFJ5P7% COFMKZ7YM015MCY7QZ58 SORR$-4/K62LEU.BJ7HHC1/2GQDOWZPHKH+YK0GQV.895VFMNHYHXLPO09:Q7.AVMVICGN$OQ49VL1534';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'nam': {'fn': 'Müller', 'fnt': 'MUELLER', 'gn': 'Céline', 'gnt': 'CELINE'}, 'dob': '1943-02-01', 'ver': '1.0.0', 'r': [{'tg': '840539006', 'fr': '2021-05-28', 'co': 'CH', 'df': '2021-06-07', 'du': '2021-11-24', 'is': 'Bundesamt für Gesundheit (BAG)', 'ci': 'urn:uvci:01:CH:16C655A5C5A504F8433B45C9'}]});
  });

});

