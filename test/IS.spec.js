const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('IS', async () => {
  it('should verify IS_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-H9VOW3UPG8926E9I0IIFQQ 43BT7/EBCG2I%57WC.H94055BD/GPWBILC9GGBYPLR-SGG10EQ928GEQW2DVJ55M8X9Q*SL$8R519$34-.EPK91010T9UKPSH9WC5PF6846A$QQ30N$K-PS- A6*P5-Q8QI/PKKMIA.G.P6A8IM%O%KIO52IL6HW6 96CX8$S4PCNL95OD6%28%%BPHQOGOC53Z9SEC5L64HX6IAS3DS2980IQODPUHLO$GAHLW 70SO:GOLIROGO3T59YLY1S7HOPC5NDO4A7R/7KAD+DGZ*OB-S-*O5W41FDNJROZ8R17:U4:U4CET7Y4R9T R3:5JTZI:GSQAF+C0VE4+Y5YP4M648DS9D6PD6U9SSA7G6MX16JUOFHP26P%+O$S5WVBDKBYLDN4DE1DMMS.ITO8ESXQGCHNHBH9N5DU3I6Z1LXFAC4O7NJ4BW*:H4$UJG1Z0JU-D1Y64-L2KV6PTSN4O I*TI304YN0YIMTGBJ5DF SSEW9T9S7Q020*WEL5';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'dob': '2000-01-01', 'nam': {'fn': 'Prófarason', 'fnt': 'PROFARASON', 'gn': 'Þarf Að Prófa', 'gnt': 'THARF<AD<PROFA'}, 'v': [{'ci': 'URN:UVCI:01:IS:VERA3333#D', 'co': 'IS', 'dn': 2, 'dt': '2021-01-01', 'is': 'Directorate of Health of Iceland Test', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': 'J07BX03'}], 'ver': '1.0.0'});
  });

  it('should verify IS_2DCode_raw_2', async () => {
    const HC1 = 'HC1:NCFV A0086OBWS3*IF%1DU315VSH78MZ1Y3SBCV/ZA+A9-N8HNJO OLDD4T22+5/9TF5JV0O+QAU$9J-D2/R91ND5AZZM0I9:45Y03/I7WWI4ZES*QB9A*47AA3P*1T3ODOVG38S1E6LSZ4DC7FT*P.4W-2P18TJQIE.982U.EK$O73AVMPK75GS:LK6UFTPPIF-YMA+T+43D 0Z/6.$9P/N0Y4ECTLS9-:DH77RIBGGKK*9B06%A92CS$-48V6SF5W2PCVK+OQ2*1%GAS3M0KNMKG*9BY%9-/2:TT8NBUC61+4%QSIE459T3KJGCW-EOPOIJKCEJB8C1NDRX LOJBQNLEMPMGC:25J1U::2EQO9L8  AQA83.4HVUGMA LV8ZLPOVL6C4C4Y40BJ13/78D95JUCHC.VA-U9*4U*6T3.68$LNZA8186K3%Y0S+6U 8CHILT6OVNOVV70E9%NXC8Z UYTBJ1CV5JB.O0%3*FLTZ2/MG*/Q1HF4*O4$GS67XPIT.FXXVOQRUKV IF%OT.-C-Q7A:V ME+:JYEV$R3$0WIH062E%7O5+NN%RFGA45I6QF*LBEPC%WOVRPCQE2LP9-8G3O02WM-F3GVWZP0-I';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'dob': '2000-01-01', 'nam': {'fn': 'Mjöggottson', 'fnt': 'MJOEGGOTTSON', 'gn': 'Ekki Vírus', 'gnt': 'EKKI<VIRUS'}, 't': [{'ci': '01 IS/ABC4556#8', 'co': 'IS', 'dr': '2021-05-14T17:46:45Z', 'is': 'Directorate of Health of Iceland Test', 'ma': '1304', 'sc': '2021-05-14T13:46:45Z', 'tc': 'Department of ClinicalMicrobiology,Landspitali', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'ver': '1.0.0'});
  });

  it('should verify IS_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8Y0PWHQ6TP8*OLA7FI1*7345J*%45%0J59D LB17:X9LGC6$2AN9I6T5XH3E2%E3EV436D6J3RG5G*0.L7WC76DJ2MJRRJSZ4HK0O054R2423423ZQT-EJFG3O3H/IBZ73PHBSMJXW44$2*ELHTCN*K49JU-2:1J0J5/5LEBFD-48YI6AGE3KVHL3HHL85MB4O-OIE9DFHW1H:Y0UE9GJPQ*4/DOPF5M4M%PERW5BQ58KP8.P180P6F0NPOVPC/9QPUHS9-PPVSP3CQE3AI-QC60U7B8BI/NIUTI5VA81K0ECM8CXVDC8C90JZJAPEDI.C$JC7KDF9CVTAQPIAK2K.C*/C/QDWZJ$7KUYCMS2NV6GJB8DJI7JSTNB95S.5 +SW*P5/UZ.VI%K4$NR35CA7G6M:N5YW6W*O/8QYIRT/5-Z7KP4*PPG%5TW5A 6YO67N65VC17A:PJ:-2MCA:2QGVLKIR/4G97U/1T 4B6YE9FE908Q 7DFB1YB+-636TX:EF5JL3D$*J3EDHFJES7 EOBB5:.10DQN3N44FJHD1SP1*VY8A-TSC4FWACLVPXQRFE88:MFDW9YR4HDG-VO3OD:9W-G:L6O/EL%J G1 SN.SKH1HW5O-04C-MR1TUID+-DDAS8%F96P9HC3B7:F5LK5DVEP SNJRMMAD.0O4TCAQ0NKJ+ET4U%-2 YM3+A+M91-MJ7O4%VRLUV/LY5H1I4U-QKXJ18GW1PZY8%JMSWNBPMTWN$CR/TRE+E5S90E6*08XE96NI+8NLYIIRJISQVWNHOV-FWC-HZZG5*D-ZP0EUIAF*6BU02RWNGJM1XB:+NNICDQA2$0DDJK/DATOCCUJ:9BHAPST';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'dob': '2000-01-01', 'nam': {'fn': 'Testingson', 'fnt': 'TESTINGSON', 'gn': 'Testing', 'gnt': 'TESTING'}, 't': [{'ci': '01 IS/ABC4557#6', 'co': 'IS', 'dr': '2021-05-17T18:21:16Z', 'is': 'Directorate of Health of Iceland Test', 'ma': '1304', 'sc': '2021-05-17T14:21:16Z', 'tc': 'Department of ClinicalMicrobiology,Landspitali', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'ver': '1.0.0'});
  });

  it('should verify IS_2DCode_raw_4', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8M-OS6LV5UIXJAVI7LGL.8RX4 D9.IOVGAI2B7Y7-RIYAB8$V NI4EFSYSC%OD3PYE9*FJBSQQC8$.AIGCY0K5$0Y.A*JOWA4S.8E68SVD+ZL62K WJM*QZXI2UA1VCSWC%PDMOLHTC$JCTVDSVD+ CAG3.XI/VBKTTREB6NJVMI-XIGOIXCIF4LEIIPBJRKI9KC+*4B4T57TM55LXK$4JR/S+:KND3NAJFU2PM41VCF71AHL-INJ8QI+MUKM1Q4IZ6IQ0N/R0/4N/5GA7E8PBO6/35H95C:7R28-KA6.0T8C2C8LC90-95IAXMFU*GSHGRKMXGG6DB4C9Q2LCIJ/HHDJLEFG5IACD9C2AKIJKIJM1M8KES/FW/I+6A58RIADGEC.-B97U: KMZN$CI%J6YRQ $UBPI3$U4KK3-SY$N%XL4DRZ22+38/8CTBOC.U7NIZ35JINQ+MN/Q19QE8Q NIZB8BWUE%PZ1EN4FD:MW5C-BEP3BRMQTUCRKNG6LIH0-BPH-J3YH$IACK5II0U:SU%5$*P%7VA3TBQQEHAI4S:T9 %DQ:H A66.RN9U5M0575VWSBQ90DPFOV-KEM R0O55V9*$94UF./0N1B8ANHUP**S238UTVHOILLUY4H:OAR*30RU3HCS2BD8WFF872UJ7P84K8PPNP15NQ*MQ6S78ULONFKTU9.3XS262OVWSGL2VHRR2QQCV8*IN*KPQ3J12*WVKQT8YR*B94V02LBCQ3MBWCZK5NC07ECQO1$7ZQED*E$R36+7Q0R2ZSE-O Y6ZT6/3F7APGX8VVAQHHUCQ79WS*EL%E+%O41C+KN+4L40QQLTBJ6S-V3 71ND806*4HYNS%DWQWFK/JFFN*9QY86A6ODEU';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'dob': '2000-01-01', 'nam': {'fn': 'Testingson', 'fnt': 'TESTINGSON', 'gn': 'Testing', 'gnt': 'TESTING'}, 't': [{'ci': 'URN:UVCI:01:IS:T123123323#7', 'co': 'IS', 'dr': '2021-05-26T13:32:15Z', 'is': 'Directorate of Health of Iceland Test', 'ma': '1304', 'sc': '2021-05-26T09:32:15Z', 'tc': 'Department of ClinicalMicrobiology,Landspitali', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'ver': '1.0.0'});
  });

  it('should verify IS_2DCode_raw_5', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8M-OS6LV5UIXJAVI7LGI/8RX4 D9.IOVGAK0BS3E-RIM6BY4N NI4EFSYS:%OD3PYE9*FJ7OIQC8$.AIGCY0K5$0Y.A*JOVFC.C8*/GB2PRQPYE9/MVZ*J.A5:S9395*CBVZ0K1H%Y0BZIGDB5LKPMIHZISVBX3C*8BEPLA8KOHSLOJJPA*709EF7AL-T4P*KQYGN%2+T4D-4HRVUMNMD3323R13A2VC-4A+2XEN QT QTHC31M3+E3CP456L X4CZKHKB-43.E3KD3OAJ5%IWZKRA38M7323Q05.$S580QW6:CGPOJI7JSTNB95V/5HFKKKUG%M/PKDVS7%NC.U+NG WUJUHIO2 .1/7AI596AL**IOS0VPVI97I97M%V9Y4KCT1+S-8FB%0XKR.RNPCGZUIQJAZGA2:UG%U:D4LC3G5U48S8BQAQI.DCDIU%PARZH3874N462D:PUO21VFFYKJ92T2O5WMHU+GDZMQAU.QVF5FJFK$VTA4SBPN%OENJ6Y.6S:4HTNV.K-RNP/U+$S1KKXD5L.RD6N72TX1G7VL2-3:GD-C8+THI RE+2BLBTEU%R96LBHGT-9TRGEDFNF/SO3D1ATL8E: 3RIR:2VPVB+*FL3VS5II5SSCMA4FYEV1ZOGK1W3E*8R3GADTR5N2DV75KR30VK%F0 U%K14J27RMF3NYCWHX70GQ*E823HO0JJPESSR9HVC%P:J4$/K5HC9SUNTH TKB3W7YUCTGV/J/6JV9K8WM0U9MGM5UNPP6$0OLPB7BOO%V-.MEH63WP.NHQ9SI/JFJ7R87HTGZWE70V/3O4+I.7LF:1000C+NZLS';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload)).to.eql({'dob': '2000-01-01', 'nam': {'fn': 'Prófarason', 'fnt': 'PROFARASON', 'gn': 'Þarf Að Prófa', 'gnt': 'THARF<AD<PROFA'}, 'v': [{'ci': 'URN:UVCI:01:IS:VERA1234#F', 'co': 'IS', 'dn': 2, 'dt': '2021-01-01', 'is': 'Directorate of Health of Iceland Test', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': 'J07BX03'}], 'ver': '1.0.0'});
  });

});

