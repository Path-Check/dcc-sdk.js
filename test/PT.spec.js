const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('PT', async () => {
  it('should verify PT_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HYVKOM6VORZEMIZ23J4LR5QR9U21OGIYQ15C4M*4RCM1$8 NI4EFSYS:%OD3PYE9*FJUKBAZ8-.A2*CEHJ5$0BRVDD4:HO85O/RVGE85$0S.8**4H0DM%2K8AZOM1JAF.7HELDXI25P9ZI4Q5%H0AN8%H0PZBITHP+PITC6FV*$K3$OHBW24FAL86H0YQCEZK.IA.C8KRDL4O54O4IGUJKJGI0JAXD15IAXMFU*GSHGRKMXGG6DBYCB-1JMJKR.KSHGXGG*EDZI9$JAQJKH+GX2MELNJIKSKE MCAOI8%MI*RF*QGOKL*GT*QQ+Q/PKI%KH N7BM1US+M5XZQNI95J0/ B1-VJD0DRG.Y7PR3YZQ H95+NERGZUIOAGIY1VS11O1MP3S-5GWKGRI- ANQDRAQ8R2V1LDCQ2ZQEZMPUNDRBRFD5/1SFITFW24PAAL3FV$HCC%4K9M5NNBTLPKB%RCHCU*CCZM6PMT:3QUTV*-4DHRCAF';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Pedro Pereira', 'gn': 'José', 'fnt': 'PEDRO<PEREIRA', 'gnt': 'JOSE'}, 'dob': '1985-07-13', 'v': [{'tg': '840539006', 'co': 'PT', 'is': 'DGS', 'ci': 'urn:uvci:01/PT/SPMS/TRC01234567890123456#1', 'vp': '1119305005', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 1, 'sd': 2, 'dt': '2021-02-18'}]});
  });

  it('should verify PT_2DCode_raw_2', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HYVKOM6VORZEMIZ23J4LR5QR9U21OGIYQ1HOSM*4RCMA0P NI4EFSYS:%OD3PYE9*FJUKBAZ8-.A2*CEHJ5$0BRVDD4:HO85O/RVGE85$0S.8**4H0DM%2K8AZOM1JAF.7HELDXI03L9ZI4Q5%H0AN8%H0PZBITHP+PITC6FV*$K3$OHBW24FAL86H0YQCEZK.IA.C8KRDL4O54O4IGUJKJGI0JAXD15IAXMFU*GSHGRKMXGG6DBYCB-1JMJKR.KSHGXGG*EDZI9$JAQJKH+GX2MELNJIKSKE MCAOI8%MI*RF*QGOKL*GT*QQ+Q/PKI%KH N7BM1US+M5XZQNI95J0/ B1-VJD0DRG.Y7PR3YZQ H95+NERGZUIOAGIY1VS11O1KP3GUKKV66.RJFF:CSDZRIN3S K6JEB+F9PIU+ECDFS UN$LR5NZV4KDWY08/1S.XEZ69R SA0O-X9%0R2QMZAT3UPLPT/NNDX3Y1EL40FQ2/0';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Pedro Pereira', 'gn': 'José', 'fnt': 'PEDRO<PEREIRA', 'gnt': 'JOSE'}, 'dob': '1985-07-13', 'v': [{'tg': '840539006', 'co': 'PT', 'is': 'DGS', 'ci': 'urn:uvci:01/PT/SPMS/TRC01234567890123456#1', 'vp': '1119305005', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 2, 'sd': 2, 'dt': '2021-02-18'}]});
  });

  it('should verify PT_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HYVKOM6VORZEMIZ24E4%%5QR9U21OGIYQ1AJIM*4RCM-Y4 NI4EFSYSS%OM6PYE9*FJUKBAZ8-.A2*CEHJ5$0BRVDD4:HO85OHTVM6Q5$0S.8**4H0DM%2K8AJOM1JAF.7HEL/ZI4Q5%H0AN8MH0V34+G9/-GPN1C88YYM9ELYIIFGIYIA GEMSH:8E0D9E2LBHHGKLO-K%FG8KES/F-1JS-KDKL:HGK3MHFE.-B97U: KI*N+CGPZIHXF+CGEQK6*PU%OC.UYVAS/VDUO/UIGSURIEKUB7PG6ZDDVBXTB*PG/UI2YUUKAN-VF$BVWPEID2:UG%U2E4HIAYNL0ETT6780DHY1YUH+$CN 7T-U9L4+QD7IFJ:GF4UOH5%-1$PJ%HR9U618DMTBPNUHPIMNHOZ8FS7-*3RLL%RR2QTM4H0Y2:0D-I9CXD';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Pedro Pereira', 'gn': 'José', 'fnt': 'PEDRO<PEREIRA', 'gnt': 'JOSE'}, 'dob': '1985-07-13', 'r': [{'ci': 'urn:uvci:01/PT/SPMS/VCC01234567890123456#2', 'is': 'DGS', 'co': 'PT', 'tg': '840539006', 'fr': '2021-02-20', 'df': '2021-04-04', 'du': '2021-10-04'}]});
  });

  it('should verify PT_2DCode_raw_4', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HYVKOM6VORZEMIZ2:D4EW1-36HV0%CMLX437Q%$CZK9N3K8SD/GPWBILC9FF9%TTR-SXF1CSQ6U7SSQY%SVJ5ZQ8O8GC4W/40YBC-9I11D.L8SNCENALOEPM9MQ9:36/97N8D6IA%DAYHILIIX2MYIIFGICCHVHH:GLQ7AVTAZ.CWPMARF.IAXHC18ASCA9.B4DBF:F0.8ELG:.CC-8LQECKEBLDSH8XAG.6A/DE4KH6+852PXN6AMIPOI3-J.WJ2OORTE3$UUZUTK96L6SR9MU9DV5 R1AMI8LHU-H/O1:O1AT1NQ1SH99H6-F0+V9.T9D 9PRAAUICO1VW5+ZE6%P4W1UVI/E2$4JY/K+.SU K*S2WJ5LXK.+K:Z2%*4 CT6OFO-27/B ZJ83BQN3RQTO*S3N2:H3YQTK+S:ZJ83BZUSR146NJ0 0KRDN4DE1D-NSPYEG7R 5UR5I6M3JJQI1J23D1ACE0RI0T5Z82RLVVMFO8%YUWAQ/8F018ZLL+%BVPANVL04EF:NWAD+E9C9QSKT.*MQGNV.A-PHW6O*20TBS91';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Pedro Pereira', 'gn': 'José', 'fnt': 'PEDRO<PEREIRA', 'gnt': 'JOSE'}, 'dob': '1985-07-13', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'tr': '260415000', 'nm': 'Roche LightCycler qPCR', 'sc': '2021-02-20T12:34:56Z', 'dr': '2021-02-20T14:56:01Z', 'tc': 'CRC Valongo', 'co': 'PT', 'is': 'DGS', 'ci': 'urn:uvci:01/PT/SPMS/TRC01234567890123456#1', 'ma': '1232'}]});
  });

  it('should verify PT_2DCode_raw_5', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HYVKOM6VORZEMIZ2:D43:O-36HV0%CMLX4W6QMOOP-ICY7QQHNO4*J8OX4SX42VLWLISN53J9OUUMK9WLIK*LWS1OI00-U$J0VUG2O8YWJIQ17XH-V9O P+S5PR5:WO$*S1CK9B9GX8G%89-8CNNG.8G%8WA46+8**4D88JCAZJJMJPB8UIE9DFHH48%*880P6BD7XH8ZL$:PAMIPOI3-J.WJ2OORTE3$UUZUTK96L6SR9MU9DV5 R1AMI8LHU-H/O1:O1AT1NQ1SH99H6-F0+V9.T9D 9PRAAUICO1VW5+ZE6%P4W1UVI/E2$4JY/K+.SU K*S2WJ5LXK.+K:Z2%*4 CT6OFO-27/B ZJ83BQN3RQTO*S3N2:H3YQTK+S:ZJ83BZUSR146NJ0 0KRDN4DE1DFPSSNV31NVVO+0T4SN0 T3HFL*JXW3ZOUBKFKWO7-U:YSTJMIVMAQV0:1 2W.LL*EV%LLXNAD/1Q$FN FBI5LTMK4D4UI:-R8W4.2WUZ3O86M F';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Pedro Pereira', 'gn': 'José', 'fnt': 'PEDRO<PEREIRA', 'gnt': 'JOSE'}, 'dob': '1985-07-13', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'tr': '260415000', 'ma': '1232', 'sc': '2021-02-20T12:34:56Z', 'dr': '2021-02-20T12:45:01Z', 'tc': 'CRC Valongo', 'co': 'PT', 'is': 'DGS', 'ci': 'urn:uvci:01/PT/SPMS/TRC01234567890123456#1'}]});
  });

});

