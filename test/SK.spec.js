const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('SK', async () => {
  it('should verify SK_2DCode_raw_6', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LGP-8+W4VGATM9Q*3J59O 2XRN7AJ0+T-MPW$NLEENKE$JDVPLW1KD0KSKE MCAOI8%MZU6R+P ZH5 JC.U% M7*PPL1UZUXZQTK9ZVFN*J3R3CPI2YUPGABT7$0O5SI:TU+MM0W5RX54W12XEYR9FQH+4JD-I/2DBAJDAJCNB-437Y4WV2Z73423ZQT*EJLD30$499TZ D6PPM4MVMUZT56+P9Q96GAE69K PBKP*JU8Q9*16VS08F545L8%HLQQ451NJP9Q9R3Q0T99D94F3MOL2ADZXI+G1 73EBGG*PFEQMZ5BTMUW5-5QNF6AYMN8VVJE83F2:6+Q6C8E-Q6RW6CB6VNMUF6SQM2R6LS6W E4LE QES*HJ6C4S52+79*BGRC%ZTXOHI7F8O5NDNZ.B$5G.XN:Q8S5FMOHNQ6S2T.6MJ3LRV47$46-E-HFAZSP0PA9A5HH16GSOIAGMJ$SL.M84UI50LECK3';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Michal', 'gn': 'Piško', 'fnt': 'MICHAL', 'gnt': 'PISKO'}, 'dob': '1999-12-24', 'r': [{'tg': '840539006', 'fr': '2021-04-21', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'df': '2021-05-19', 'du': '2021-10-21', 'ci': 'urn:uvci:01:SK:A7C71100B145444B827299717EB2FFAE'}]});
  });

  it('should verify SK_2DCode_raw_7', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LG16P+W4VGAJUPTEWJ59JYL4ULQR9N8V5VC9:BPCNJINQ+MN/Q19QE8QEA7IB65C94JBL1LLKD91G3MSNLPLF9FFF4DCDFHNJJZ7H:Z2+*431TIYC0NN/TVAWGML78AL**I%2HW77ADF8JF5A75AL5:4A93.E3IFT.EJEG3$X4VT6-G9+E93ZM$96PZ6+Q6X46%E5%NPC71RF6+17S%MBX6%E5EPPQF67460R6646499XY9-96OF6-G9R.9GAINF67J6QW6-.QSE6-96 +MKI6OF6B$Q:667F0+G9$I8WW6JTMZ1H6:I51DQ8H+3HMJVQ0J+*40$499TP/N.XI/VBXYS*8B.IJI7JCWKEIIPBJ7OIWHSG7JX3C3I1GUAD/9BL5UZ5:AAH6Q2:55+P2T9PK95%LH/56SP.E5BQ95ZM376GH1-2NZ*61H6EL6Y+M4:65:6-964LEGS6F%6TW6RF6846*/EC.M B6UCE0DWE2TK83INN7WO571WEETIBD6WS35QXNIRO82RVTQS9M*W9-02MYMPR4:A5L8Q6*LXWVK*R4ATGU8LSL*UQD*2NIEVZ5ZN3DWT.:AE U2NI';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Nemohúca', 'gn': 'Vladimíra', 'fnt': 'NEMOHUCA', 'gnt': 'VLADIMIRA'}, 'dob': '1938-07-26', 't': [{'tg': '840539006', 'tt': 'LP217198-3', 'tr': '260415000', 'ma': '1242', 'sc': '2021-05-20T15:21:41+00:00', 'dr': '2021-05-20T15:36:31+00:00', 'tc': 'SWOT Levice', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:C1B1F5587377412FA2C65621023AE9D4'}]});
  });

  it('should verify SK_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LG4/8+W4VGAXOE4+4J59BZ6%-OD 4YQFPF6R:5SVBWVBDKBYLDN4D74D$ZJ*DJWP42W5J3U4OG7.R7%NC.UPTUD*Q9RK7RMEN4CD1B+K8AV2PTO*N--T0SFXZQ H9RQGX-FO2WYZQ2J95J02O8..V$T7%$D4J8$T7T$7YNGHM4PRAAUICO1DV59UE6Q1M650 LHZA0D9E2LBHHGKLO-K%FGLIA5D8MJKQJK JMDJL9GG.IA.C8KRDL4O54O4IGUJKJGI.IAHLCV5GVWNZIKXGG JMLII7EDTG91PC3DE0OARH9W/IO6AHCRTWA4EQN95N14Z+HP+POC1.AO5PIZ.VTZOSV0I+QWZJHN1ZBQR*MTNK EM5MGPI5A-M8F7AJOZNV9JHKIJYE9*FJ+UVAZ8-.A2*CEHJ5$0O/A%4S22Q%*5Q 0Y/DU*5X3MK%4Q+4E/HY:G12JN6P.3T-0L0%0D$0172X.J07N-3BB B.$JJ9S:5DS$A/RG5SHW3E:-L%VU3PNV.GXTORKT*ZVNQEEX2C9A/DP:TG5/7S$ONATED4SWP08KXT0V-29+CDZV +DE20%CJH5';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Šimon', 'gn': 'Petrovič Lužičinský', 'fnt': 'SIMON', 'gnt': 'PETROVIC<LUZICINSKY'}, 'dob': '1990-01-01', 'v': [{'tg': '840539006', 'vp': '1119305005', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 1, 'sd': 2, 'dt': '2021-05-14', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:C0DA0FF1D1EE4643A81F953778520E0A'}]});
  });

  it('should verify SK_2DCode_raw_2', async () => {
    const HC1 = 'HC1:NCF6X3.X9PO0%20VL33UI.J8Z1KO1F6UF6SCZ L81SYB4OM5G/E6AF-/ER:PFHFR.P7VIMZI%QGJLP5OIX+H1$R$+026DMI988AZUHKQS$VJACV96ONECL-U2OD/ 62.Q4-JB6272U6XTEFPB/JPUV1JJL9NUPRTRM-T9OR8-EA1EQ61B3G0207237CY07/OLKJFOT/0GOFGO MCX9 +Q+QG4IJ3TH5Q8SEP53JZ/MF3K1D36PPA$FL:J81A60P-YHE19MBLOEH:E5 35-6B.M4*6CTA1$LKJ48C916+6Q5AR*KRC5DW5NLPU55RC16E1360003KOTKA8HB0PR8M78/$SP091INZMI72N U2+BIWBH+LS37JPZAFCH276IT7M/JBCI8V3CJ322LBAQ-CWY6BH95+0WC8BNYNQ9QBAJ+3R%YE:8L PVJDMI40E-U*AJUBK5BGMQ057T/R0GA8+GAXB9RO20A7YPP+NPB6DQGM+.UZGM/RNC+VHT3M SO%V%.FN2V3*DBDPWCV+MNW.JXS2-1F92RL4MMIHT/UI.9K0UBDWN0UA0NI.VR3VH1ERLV$%SWLH';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Sčasný', 'gn': 'Svätozár', 'fnt': 'SCASNY', 'gnt': 'SVAETOZAR'}, 'dob': '1984-09-27', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 1, 'sd': 2, 'dt': '2021-05-18', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:4DC1082B01524B868C87BE23345B3587'}]});
  });

  it('should verify SK_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LGP5PLQ9HXKD0JLS7OGI+MDCSFU96UIR NI4EFSYS1-ST*QGTA4W7.Y7B-S-*O5W41FDKGL.Z8$:OLF9OIFZC8Y/67*KK%I6ALD-IAY0MDFYXV8ALD-I:X0YO74$0NS4.$S6ZCJKBDQJDG3IFT383N:I$+LPF5RBQ746B46O1N646RM93O5RF6$T61R6B46646O$9KZ56DE/.QC$Q7J62:6LZ6%V9Q$95:UENEUW6200DM88Q9C KXU70%KLR2C KPLI8J4RK46YBCPC5QC2%K:XFJO8OH69M50*VZM9 $U/E25P2-GA*PE+E6XV72UQDSH%KOLG1%HLE+0ILT+R0J+SYW4 1D0$4*2D8ITB+2SEB7:I/2DY735HBYQFID7UBJOF7423UC7NJJ.FJRK396BB930DNSK3:67ZQB76B.43HRA+JFTWA:VJ-E3ETQ7:UO$129KSKD:*F3MF44P AD87HXUNPTE.FQL-9J*GPQI/.8PCVGG2OJ5YABX2NNNM$-B:OAEWUN1IG:NK/H-ZTK.BXPKRCTI-SEC9X:A000G99UWN';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Prism', 'gn': 'Róbert', 'fnt': 'PRISM', 'gnt': 'ROBERT'}, 'dob': '1955-04-21', 'v': [{'tg': '840539006', 'vp': '1119305005', 'mp': 'EU/1/21/1529', 'ma': 'ORG-100001699', 'dn': 1, 'sd': 2, 'dt': '2021-03-30', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:AD49A022B66F43189238DC38B78D8027'}, {'tg': '840539006', 'vp': '1119305005', 'mp': 'EU/1/21/1529', 'ma': 'ORG-100001699', 'dn': 2, 'sd': 2, 'dt': '2021-05-19', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:AD49A022B66F43189238DC38B78D8027'}]});
  });

  it('should verify SK_2DCode_raw_8', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LG+/8+W4VGARUPPBQJ59*%LTYUQR9N8V5VC9:BPCNJINQ+MN/Q19QE8QEA7IB65C94JBC/DO/EOFFG-9$JDS1G/MSLF9CEF90GIGF KP8EFPD776S7NST.7E1M67WD2I9NTIV4E0G/:FHJP7NVDEBK3JD*2$$0VONG0HSX4+M5TK96L6SR9MU9DV5 R1AMI4H9LUFA$PA$PSVEAMI8LHU-H/O1:O1AT1NQ1FNHJK5I$HWVHOIOJU1IQ1R L* 9-V9DYM4R16CGZ95ZIT**4H*A4:GXMRU+SZDG0$J2-TW*PZ+P/Q8/CSIQF5RUNTICZUF$36PPM4MVMUZT56+P9Q96GAE69K PBKP*JU8Q9*16VS08F57ALD-IF+2T259ET%4JP.CIF0M C8ITB+2SEB7:I01D4/LGH1-2N2Y6HPEVNMSM66O6646:96P*EQ M%/E-96XW6GB65VEGS6PY6BBE:HJO2B2TJNRN1KOY$B$OI64ER7DOVD8EDB8NK$L0*N1EEEFCOE93XDK B0BOKY12INJGRGQT.:B$I1SEPVE4ANS$0DOEWAN2C5JV50NJQO/H';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Skywalkerová', 'gn': 'Nina', 'fnt': 'SKYWALKEROVA', 'gnt': 'NINA'}, 'dob': '1978-05-21', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'tr': '260415000', 'sc': '2021-05-20T12:34:56+00:00', 'dr': '2021-05-20T12:45:01+00:00', 'tc': 'Poliklinika Mýtna', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:E2FA2860F180475B99CFD15745AC12E4'}]});
  });

  it('should verify SK_2DCode_raw_4', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LGU-8+W4VGA QF2K2A K:6TGMHQR9N8V5VC9:BPCNJINQ+MN/Q19QE8QEA7IB65C94JBACA98W %F4MV-PV:X0BB5F-2YV2W.4 /KWYCE K*S2 CTB4T+*431T*N2JLVHLVBUF:*00KVW378V0ML78AL**IA%0I.G5RV0NNJ475AL5:4A93QHBZQT+EJ*E3N*4HZ6-G9+E93ZM$96PZ6+Q6X46+E5+DP:Q67ZMA$6BVU SI5K1*TB3:U-1VVS1UU1HF83$OHBW24FAL86H0VOCIL8-TIDXI03L6QS03L9ZI4Q5%H0KCH35T0OP9682R44$2FKT$X40YC/9TF4TEBFD-48YIA5557TC/ST0T-S0EYJ2YUQJAGUE5MGAVUHG2PK6NTI4L6Y*U6VH6ZL4XP:N6ON13.L2:NIT94-RGTB0V1-V9LX3+V9K-RJS5JW1J%JOZ5N 9+V9N-PAT1XJ4Z-B ZLE 51AMP*BSVLW7S6UMW87.G8 S3DD8VCV0:84V6G:23$1F-L8ODNU7$O6OYD990XP1 -GPX3FT94IHZFV7NC08N*7R/*DA%8ISBOPH';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Poľnohospodárska', 'gn': 'Petronela', 'fnt': 'POLNOHOSPODARSKA', 'gnt': 'PETRONELA'}, 'dob': '1991-06-09', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1507', 'ma': 'ORG-100031184', 'dn': 2, 'sd': 2, 'dt': '2021-06-07', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:4DF6D90D57AB46FF830CB1874B477101'}]});
  });

  it('should verify SK_2DCode_raw_5', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QO-.O9B3QZ8Y*M9WL7LG$.8+W4VGA$P9GE2A KLK7.VS7TI9-NSA3/-2E%5G%5TW5A 6YO6XL6Q3QR$P*NIC0J-C4X3CFZI%5JNHJ//E IKU3DR/FZ/FU6T5+BD/53X75L6DO6I.S27T+*P3-SY$N5K6-24E09S5JXBWN:832AHBWXBWW1AG34SA7G6MTN4UVQJ OLHP1A6+V4YC5/HQ3POXCRH99*ERYKMXEE5IAXMFU*GSHGRKMXGG6DBYCB-1JMJKR.KSHGXGG7EDA.D90I/EL6KKYHIL4O GLXCI.EJJ14B2MT6DXP07*435T.A53XHS-O3XH395*CBVZ0K1H$$0VONYZ00OP658XW44$2FKT$X40YC/9TF4TEBFD-48YIA5557TC/ST0T-S0EYJ2YUQJAGUE5MGAVUHG2PK6NTI4L6Y*U6VH6ZL4XP:N6ON13.L2:NGTBU-H %J0V1I$HJT9XY93+PLY59$B**JS%B. B$3NDIB9M7:57ALSL99%Z6.I4$YDPON-1TD8MBBWP*6JPNWMFIZ78LENRP%9M3BQQOAO1F*YRE8FZATIXNZCWGMG*1GCOAL8N2TF4906ED7.1A-7$*B6502C674';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.credential)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Orbandyová Igorovičová', 'gn': 'Viktória', 'fnt': 'ORBANDYOVA<IGOROVICOVA', 'gnt': 'VIKTORIA'}, 'dob': '1980-12-31', 'v': [{'tg': '840539006', 'vp': '1119305005', 'mp': 'EU/1/20/1525', 'ma': 'ORG-100001417', 'dn': 1, 'sd': 1, 'dt': '2021-05-20', 'co': 'SK', 'is': 'National Health Information Center, Slovakia', 'ci': 'urn:uvci:01:SK:D927CA0E205E44678CE3C5E7E14159CA'}]});
  });

});

